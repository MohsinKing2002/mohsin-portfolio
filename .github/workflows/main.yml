#workfolow name
name: Automatic Deployment

on:
  push:
    branches:
      - master

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      #checkout using github checkout
      - name: Github checkout
        uses: actions/checkout@v4
        with:
          persist-credentials: false

      #install node js
      - name: Install Node Js
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"

      #Create the Data file
      - name: Create constants.js file
        run: |
          echo "${{ secrets.PROJECT_DATA }}" > ./src/data/constants.js

      #install the dependecies
      - name: Install Dependencies
        run: npm install

      #create a production build
      - name: Create a Build
        run: npm run build

      #deploy the changes
      - name: Deploy Changes
        run: npm run deploy

      #show success message
      - name: Success Message
        run: echo 'Changes are deployed :)'
